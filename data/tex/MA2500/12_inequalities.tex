% !TEX root = main.tex
%----------------------------------------------------------------------
\chapter{Concentration Inequalities}\label{chap:ineqs}
%----------------------------------------------------------------------
%----------------------------------------------------------------------
\section{Markov's inequality}
%----------------------------------------------------------------------

If the distribution of a random variable is not known, probabilities can be estimated using the moments of the distribution. A simple upper bound on the tail probability of a non-negative random variable is provided by \emph{Markov's inequality}.

% theorem: markov inequality
\begin{theorem}[Markov's inequality]
Let $X\geq 0$ be any non-negative random varible with finite mean. Then for every $a>0$,
\[
\prob(X\geq a) \leq \frac{\expe(X)}{a}.% \qquad\text{for any}\quad a>0.
\]
\end{theorem}

% proof
\begin{proof}
%Consider the event $A = \{X\geq a\} = \{\omega: X(\omega)\geq a\}$.
Let $I_A$ be the indicator function of event $A = \{\omega: X(\omega)\geq a\}$. 
\[
I_A(\omega) = \left\{\begin{array}{ll} 0 & \text{if}\ X(\omega) < a, \\ 1 & \text{if}\ X(\omega)\geq a. \end{array}\right.
\]

	\bit
	\it If $\omega\in A$, then $X(\omega)   \geq a = a I_A(\omega)$.
	\it If $\omega\notin A$, then $X(\omega)\geq 0 = a I_A(\omega)$.
	\eit
In either case, we have $X(\omega)\geq a I_A(\omega)$, so by the monotonicity of expectation (Theorem~\ref{thm:prop_expe_non-neg}),
\[
\expe(X) \geq a\expe(I_A) = a\prob(A) \equiv a\prob(X\geq a).
\]
Hence $\prob(X\geq a) \leq \expe(X)/a$, as required.
\end{proof}

% example
\begin{example}
A fair die is rolled once. Use Markov's inequality to find an upper bound on the probability that we observe a score of at least $5$.
\end{example}

\begin{solution}
Let $X$ be the number shown on the die. Then $X$ is a non-negative random variable with expectation $\expe(X) = 7/2$.

Markov's inequality yields the upper bound 
\[
\prob(X\geq 5) \leq \frac{\expe(X)}{5} = \frac{7}{10}.
\]
In this example we know that $\prob(X\geq 5)=1/3$, which illustrates that Markov's inequality yields only crude bounds on tail probabilites. Indeed, for the probability $\prob(X\geq 3)$ Markov's inequality yields
\[
\prob(X\geq 3) \leq \frac{\expe(X)}{3} = \frac{7}{6}.
\]
This tells us nothing useful (because we know that $\prob(X\geq 3)\leq 1$). 
\end{solution}

% theorem: markov - general form
\begin{theorem}[Markov's inequality (General form)]
Let $X$ be any random varible with finite mean, and let $g:\R\to[0,\infty)$ be a non-negative function. Then for every $a>0$,
\[
\prob\big[g(X)\geq a\big] \leq \frac{\expe\big[g(X)\big]}{a}.
\]
\end{theorem}

% proof
\begin{proof}
Let $I_A$ be the indicator function of the event $A = \big\{\omega: g\big[X(\omega)\big]\geq a\big\}$. 
\[
I_A(\omega) = \left\{\begin{array}{ll} 0 & \text{if}\ g\big[X(\omega)\big] < a, \\ 1 & \text{if}\ g\big[X(\omega)\big]\geq a. \end{array}\right.
\]
Then $g(X)\geq a I_A$, so by the monotonicity of expectation,
\[
\expe\big[g(X)\big] \geq a\expe(I_A) = a\prob(A) = a\prob(X\geq a).
\]
which concludes the proof.
\end{proof}

%----------------------------------------------------------------------
\section{Chebyshev's inequality}
%----------------------------------------------------------------------

%\emph{Chebyshev's inequality} provides an upper bound on the absolute deviation of a random variable from its mean:
An upper bound on the absolute deviation of a random variable from its mean is provided by \emph{Chebyshev's inequality}.

% corollary: chebyshev's inequality
\begin{corollary}[Chebyshev's inequality]
Let $X$ be any random varible with finite mean. Then for all $\epsilon>0$,
\[
\prob(|X-\expe(X)|\geq \epsilon) \leq \frac{\var(X)}{\epsilon^2}.
\]
\end{corollary}

% proof
\begin{proof}
Take $g(X)=\big(X-\expe(X)\big)^2$ and $a=\epsilon^2$ in Markov's inequality,
\begin{align*}
\prob(|X-\expe(X)|\geq \epsilon) 
	& = \prob\big[\big(X-\expe(X)\big)^2\geq \epsilon^2\big] 
	\leq	\frac{\expe\big[\big(X-\expe(X)\big)^2\big]}{\epsilon^2} 
	= \frac{\var(X)}{\epsilon^2},
\end{align*}	
as required.
\end{proof}

\newpage

% example: chebyshev
\begin{example}
Suppose that $\expe(X) = 0$ and $\var(X) = 1$. Find an integer value $k$ such that $\prob(|X|\geq k) \leq 0.01$.
\end{example}

\begin{solution}
$X$ is not non-negative, so we can not use Markov's inequality here. By Chebyshev's inequality,
\[
\prob(|X|\geq k) = \prob(|X-\expe X|\geq k) \leq \frac{\var(X)}{k^2} = \frac{1}{k^2} \leq \frac{1}{100}
%\qquad\text{so we need $k\geq 10$.}
\]
so we need $k\geq 10$.
\end{solution}

% example
\begin{example}
Let $X$ be a continuous random variable with expected value $3.6$ and standard deviation $1.2$. Find a lower bound for the probability $\prob(1.2\leq X\leq 6.0)$.
\begin{solution} % <<<
\par
The event $\{1.2 \leq X \leq 6.0\}$ can be written as $\{|X-3.6| \leq 2.4\}$, and by Chebyshev's inequality,
\[
\prob(|X-3.6|> 2.4) \leq \frac{\var(X)}{2.4^2} = \frac{1.2^2}{2.4^2} = \frac{1}{4}.
\]
Thus $\prob(1.2 \leq X \leq 6.0) \geq 3/4$.
\end{solution}
\end{example}

%----------------------------------------------------------------------
\section{Bernstein's inequality}
%----------------------------------------------------------------------
\begin{theorem}[Bernstein's inequality]\label{thm:bernstein}
Let $X$ be a random variable. Then for all $t>0$,
\[
\prob(X>a) \leq e^{-ta}\expe(e^{tX}).
\]
\end{theorem}
% proof
\begin{proof}
For any non-negative random variable $Y$, Markov's inequality says that
\[
\prob(Y>y) \leq \frac{\expe(Y)}{y}.
\]
Let us take $Y=e^{tX}$ and $y = e^{ta}$. Then $Y$ is non-negative, so
\[
\prob(e^{tX} > e^{ta}) \leq \frac{\expe(e^{tX})}{e^{ta}} = e^{-ta}\expe(e^{tx}).
\]
The result then follows by the fact that the exponential function is monotonic increasing, which means that $\prob(X > a)=\prob(e^{tX} > e^{ta})$.
\end{proof}

%%----------------------------------------------------------------------
%\section{Chernoff bounds}
%%----------------------------------------------------------------------
%\begin{theorem}[Chernoff bound]
%Let $X_1,X_2,\ldots,X_n$ be independent random variable, and let
%\[
%S = \sum_{i=1}^n X_i.
%\]
%Then for any $t>0$,
%\[
%\prob(S\leq a) \leq e^{ta}\prod_{i=1}^n\expe(e^{-tX_i})
%\]
%\end{theorem}

%% proof
%\begin{proof}
%\end{proof}

\newpage

%----------------------------------------------------------------------
\section{Exercises}
\input{ex12_inequalities}
%----------------------------------------------------------------------

%======================================================================
\endinput
%======================================================================
