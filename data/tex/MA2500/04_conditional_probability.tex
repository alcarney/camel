% !TEX root = main.tex
%----------------------------------------------------------------------
\chapter{Conditional Probability}\label{chap:conditional_probability}
%----------------------------------------------------------------------
%----------------------------------------------------------------------
\section{Conditional probability}
%----------------------------------------------------------------------

Let $(\Omega,\mathcal{F},\prob)$ be a probability space, and let $B\in\mathcal{F}$.

% definition
\begin{definition}
If $\prob(B)>0$, the \emph{conditional probability of $A$ given $B$} is defined to be
\[
\prob(A|B) = \frac{\prob(A\cap B)}{\prob(B)}.
\]
\end{definition}

%----------------------------------------------------------------------
\section{Bayes' theorem}
%----------------------------------------------------------------------

\begin{definition}
A countable collection of sets $\{A_1,A_2,\ldots\}$ is said to form a \emph{partition} of a set $B$ if 
\ben
\it $A_i\cap A_j = \emptyset$ for all $i\neq j$, and 
\it $B \subseteq \bigcup_{i=1}^{\infty} A_i$.
\een
\end{definition}

% theorem: law of total probability
\begin{theorem}[The Law of Total Probability]\label{thm:law_of_total_probability}
If $\{A_1,A_2,\ldots\}$ is a partition of $B$, then
\[
\prob(B) = \sum_{i=1}^{\infty} \prob(B\cap A_i) = \sum_{i=1}^{\infty} \prob(B|A_i)\prob(A_i)
\]
\end{theorem}

% theorem: Bayes' theorem
\begin{theorem}[Bayes' Theorem]\label{thm:bayes}
If $\{A_1,A_2,\ldots\}$ is a partition of $B$ where $\prob(B)>0$, then
\[
\prob(A_i|B) = \frac{\prob(B|A_i)\prob(A_i)}{\sum_j \prob(B|A_j)\prob(A_j)}
\]
\end{theorem}

%----------------------------------------------------------------------
\section{Independence}
%----------------------------------------------------------------------
% definition: independence
\begin{definition}
Two events $A$ and $B$ are said to be \emph{independent} if $\prob(A|B)=\prob(A)$, or equivalently,
\[
\prob(A\cap B) = \prob(A)\prob(B).
\]
\end{definition}

% definition: independence
\begin{definition}
A collection of events $\{A_1,A_2,\ldots\}$ is said to be 
\ben
\it \emph{pairwise independent} if $\prob(A_i\cap A_j)=\prob(A_i)\prob(A_j)$ for all $i\neq j$.
\it \emph{totally independent} if, for every finite subset 
$\{B_1,B_2,\ldots,B_m\}\subset \{A_1,A_2,\ldots\}$, 
\[
\prob(B_1\cap B_2\cap \ldots \cap B_m) = \prob(B_1)\prob(B_2)\cdots\prob(B_m).
\]
This can also be written as $\prob\left(\bigcap_{j=1}^m B_j\right) = \prod_{j=1}^m \prob(B_j)$.
\een
\end{definition}

% remark
\begin{remark}
Total independence implies pairwise independence, but not vice versa.
\end{remark}

%%----------------------------------------------------------------------
\section{Conditional probability spaces}
%----------------------------------------------------------------------
Let $(\Omega,\mathcal{F},\prob)$ be a probability space, and let $B\in\mathcal{F}$.
	
% theorem
\begin{theorem}\label{thm:cond_sigma_field}
%If $B\neq\emptyset$, then t
The family of sets $\mathcal{G} = \{A\cap B: A\in\mathcal{F}\}$ is a $\sigma$-field over $B$.
\end{theorem}

\begin{remark}
$\mathcal{G}$ contains all sets of the form $A\cap B$, where $A$ is some element of $\mathcal{F}$. This means that $A'\in\mathcal{G}$ if and only if there is some $A\in\mathcal{F}$ for which $A'=A\cap B$.
%For example, suppose that $\Omega=[0,1]$ and $B=[1/4,1/2]$. 
%\bit
%\it If $A=[1/3,2/3]\in\mathcal{F}$ then $A\cap B = [1/3,1/2]\in\mathcal{G}$.
%%\it If $A=[0, 1/5]\in\mathcal{F}$ then $A\cap B = \emptyset\in\mathcal{G}$.
%\it If $A=[1/5,4/5]\in\mathcal{F}$ then $A\cap B = B\in\mathcal{G}$.
%\eit
\end{remark}

% proof
\begin{proof}
To show that $\mathcal{G}$ is a $\sigma$-field over $B$, we need to show that
\ben
\it $B\in\mathcal{G}$, 
\it if $A'\in\mathcal{G}$ then $B\setminus A'\in\mathcal{G}$, and
\it if $A'_1,A'_2,\ldots\in\mathcal{G}$ then $\cup_{i=1}^{\infty} A'_i\in\mathcal{G}$.
\een

\ben 
\it % << (i)
Clearly, $B\in\mathcal{G}$ because there is a set $A\in\mathcal{F}$ for which $B = A\cap B$, namely the set $B$ istelf.

\it % << (ii)
Let $A'\in\mathcal{G}$. Then there exists a set $A\in\mathcal{F}$ for which $A'=A\cap B$. 
\par
The complement of $A'$ relative to $B$ can be written as
\[
B\setminus A'	= B\setminus (A\cap B)	= \big[(A\cap B)^c\big] \cap B.
\]
\bit
\it 
$\mathcal{F}$ is closed under pairwise unions and complementation. 
\it 
Since $A,B\in\mathcal{F}$, it thus follows that $(A\cap B)^c \in\mathcal{F}$. 
\it
Hence $B\setminus A'$ can be written as $\big[(A\cap B)^c\big]\cap B$ where $\big[(A\cap B)^c\big]\in\mathcal{F}$
\it
This shows that $B\setminus A\in\mathcal{G}$.
\eit

\it % << (iii)
Let $A'_1,A'_2,$ be elements of $\mathcal{G}$. Then for each $A'_i$ there exists some $A_i\in\mathcal{F}$ such that $A'_i=A_i\cap B$. Using the fact that set intersection is distributive over set union,
\[
\cup_i A'_i 
	= \cup_i(A_i\cap B) 
	= \big(\cup_i A_i\big) \cap B.
\]
\bit
\it $\mathcal{F}$ is closed under countable unions.
\it
Since $A_1,A_2,\ldots\in\mathcal{F}$, it thus follows that $\cup_i A_i \in\mathcal{F}$.
%\it
%Hence $\cup_{i=1}^{\infty} A'_i$ can be written in the form $\big(\cup_{i=1}^{\infty} A_i\big)\cap B$ where $\big(\cup_{i=1}^{\infty} A_i\big)\in\mathcal{F}$.
\it
Hence $\cup_i A'_i$ can be written in the form $\big(\cup_i A_i\big)\cap B$ where $\cup_i A_i\in\mathcal{F}$.
\it
This shows that $\cup_i A'_i\in\mathcal{G}$.
\eit
\een
Thus we have shown that $\mathcal{G}$ is a $\sigma$-field over $B$, as required.
\end{proof}

%----------------------------------------------------------------------
% theorem
\begin{theorem}\label{thm:cond_prob_measure}
Let $(\Omega,\mathcal{F},\prob)$ be a probability space, let $B\in\mathcal{F}$, and let $\mathcal{G} = \{A\cap B: A\in\mathcal{F}\}$. 
\par
If $\prob(B)>0$, then
\[
\begin{array}{rccl}
	\mathbb{Q}: 	& \mathcal{G} & \to & [0,1] \\
					& A'			& \mapsto	& \prob(A'|B)
\end{array}
\]
is a probability measure on $(B,\mathcal{G})$.
\end{theorem}

% definition
\begin{remark}
$(B,\mathcal{G},\mathbb{Q})$ is called a \emph{conditional probability space}..
\end{remark}

% proof
\begin{proof}
To show that $\mathbb{Q}$ is a probability measure on $(B,\mathcal{G})$, we need to show that 
\bit
\it $\mathbb{Q}(B) = 1$,
\it $\mathbb{Q}\left(\textstyle\bigcup_i A'_i\right) = \sum_i \mathbb{Q}(A'_i)$ whenever the $A'_i\in\mathcal{G}$ are pairwise disjoint.
\eit
First,
\[
\mathbb{Q}(B) = \prob(B|B) = \frac{\prob(B\cap B)}{\prob(B)} = \frac{\prob(B)}{\prob(B)} = 1.
\]
To prove countable additivity, let $A'_1,A'_2,\ldots$ be pairwise disjoint events in $\mathcal{G}$. Then, using the fact that set intersection is distributive over set union,
%\begin{align*}
%\mathbb{Q}\left(\textstyle\bigcup_i A'_i\right) = \prob\left(\textstyle\bigcup_i A'_i\,|\,B\right)
%	& = \frac{\prob\left(\left(\textstyle\bigcup_i A'_i\right)\cap B\right)}{\prob(B)} \\[1.5ex]
%	& = \frac{\prob\big[\cup_i (A'_i \cap B)\big]}{\prob(B)} \\[1.5ex]
%	& = \frac{\sum_i \prob(A'_i \cap B)}{\prob(B)} \quad\text{because the $A'_i$ are disjoint}, \\[1.5ex]
%	& = \sum_i \frac{\prob(A_i \cap B)}{\prob(B)}
%	& = \sum_i \mathbb{Q}(A'_i)
%\end{align*}
\begin{align*}
\mathbb{Q}(\cup_i A'_i) = \prob(\cup_i A'_i\,|\,B)
	& = \frac{\prob\big[(\cup_i A'_i) \cap B\big]}{\prob(B)} \\[1.5ex]
	& = \frac{\prob\big[\cup_i (A'_i \cap B)\big]}{\prob(B)} \\[1.5ex]
	& = \frac{\sum_i \prob(A'_i \cap B)}{\prob(B)} \quad\text{because the $A'_i$ are disjoint}, \\[1.5ex]
	& = \sum_i \frac{\prob(A_i \cap B)}{\prob(B)} \\
	& = \sum_i \mathbb{Q}(A'_i).
\end{align*}
%\begin{align*}
%\mathbb{Q}(\cup_i A'_i) = \prob(\cup_i A'_i|B)
%	& = \prob\big[(\cup_i A'_i) \cap B\big]/\prob(B) \\
%	& = \prob\big[\cup_i (A'_i \cap B)\big]/\prob(B) \\
%	& = \sum_i \prob(A'_i \cap B) / \prob(B) \quad\text{because the $A'_i$ are disjoint}, \\
%	& = \sum_i \prob(A_i \cap B) / \prob(B)
%	& = \sum_i \mathbb{Q}(A'_i)
%\end{align*}
%\qed
Thus we have shown that $\mathbb{Q}$ is a probability measure on $(\Omega,\mathcal{G})$, as required.
\end{proof}

% remark
\begin{remark}
We have shown that $\mathbb{Q}$ is a probability measure on $(B,\mathcal{G}$). Using an almost identical argument, it can be shown that $\mathbb{Q}$ is also a probability measure on $(\Omega,\mathcal{F}$).  
\bit
\it In the probability space $(B,\mathcal{G},\mathbb{Q})$, outcomes $\omega\notin B$ are excluded from consideration.
\it In the probability space $(\Omega,\mathcal{F},\mathbb{Q})$, outcomes $\omega\notin B$ are assigned probability zero.
\eit
\end{remark}


\newpage
%----------------------------------------------------------------------
\section{Exercises}
\input{ex04_conditional_probability}
%----------------------------------------------------------------------

%======================================================================
\endinput
%======================================================================
